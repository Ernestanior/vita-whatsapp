# 📱 真实 WhatsApp 测试指南

**目的**: 通过真实 WhatsApp 测试所有 Phase 3 功能  
**测试用户**: 6583153431  
**预计时间**: 20-30 分钟

---

## 🚀 测试前准备

1. ✅ 确保 WhatsApp 已连接到生产环境
2. ✅ 确保最新代码已部署到 Vercel
3. ✅ 准备好手机，打开 WhatsApp

---

## 📋 测试流程

### 第一部分：连续打卡系统 (5 分钟)

#### 测试 1: 查看连续状态

**发送**: `streak`

**预期结果**:
```
🔥 你的连续打卡

📊 当前连续: X 天
🏆 最长连续: X 天
🍽️ 总餐数: X 餐
❄️ 可用冻结: X 次

继续保持！lah
```

**验证**:
- [ ] 显示当前连续天数
- [ ] 显示最长连续记录
- [ ] 显示总餐数
- [ ] 显示冻结次数
- [ ] 使用新加坡华语风格

---

#### 测试 2: 中文命令

**发送**: `连续`

**预期结果**: 与 `streak` 相同

**验证**:
- [ ] 中文命令识别正常

---

#### 测试 3: 自然语言

**发送**: `我打卡多少天了`

**预期结果**: 显示连续信息

**验证**:
- [ ] 自然语言理解正常

---

### 第二部分：预算追踪系统 (5 分钟)

#### 测试 4: 查看预算（未设置）

**发送**: `budget`

**预期结果**:
```
💰 每日预算

你还没有设置预算 leh

要设置预算吗？
发送: budget set 1800
```

**验证**:
- [ ] 提示未设置
- [ ] 提供设置指引

---

#### 测试 5: 设置预算

**发送**: `budget set 1800`

**预期结果**:
```
✅ 预算已设置！

💰 每日目标: 1800 kcal
📊 今日消耗: X kcal
🎯 剩余: X kcal

Good lah! 我会帮你追踪的。
```

**验证**:
- [ ] 预算设置成功
- [ ] 显示当前消耗
- [ ] 显示剩余卡路里

---

#### 测试 6: 查看预算（已设置）

**发送**: `budget`

**预期结果**: 显示预算状态

**验证**:
- [ ] 显示目标和消耗
- [ ] 显示剩余卡路里
- [ ] 显示百分比

---

#### 测试 7: 中文预算命令

**发送**: `预算`

**预期结果**: 与 `budget` 相同

**验证**:
- [ ] 中文命令正常

---

### 第三部分：偏好管理系统 (5 分钟)

#### 测试 8: 查看偏好（未设置）

**发送**: `preferences`

**预期结果**:
```
⚙️ 你的饮食偏好

还没有学习到你的偏好 leh

告诉我：
• "我不吃肉"
• "我对花生过敏"
• "我喜欢吃鸡肉饭"

我会记住的！
```

**验证**:
- [ ] 提示未设置
- [ ] 提供示例

---

#### 测试 9: 设置素食偏好

**发送**: `我不吃肉`

**预期结果**:
```
✅ 明白了！

我记住了你是素食者。
以后会给你素食建议 lah！

发送 preferences 查看你的偏好。
```

**验证**:
- [ ] 理解素食偏好
- [ ] 确认保存
- [ ] 友好回复

---

#### 测试 10: 设置过敏

**发送**: `我对花生过敏`

**预期结果**:
```
✅ 收到！

我记住了你对花生过敏。
以后会帮你检查的 leh！

发送 preferences 查看你的偏好。
```

**验证**:
- [ ] 理解过敏信息
- [ ] 确认保存

---

#### 测试 11: 查看偏好（已设置）

**发送**: `preferences`

**预期结果**:
```
⚙️ 你的饮食偏好

🥗 饮食类型: 素食
⚠️ 过敏原: 花生
❤️ 最爱食物: (自动学习中)

要更新？直接告诉我 lah！
```

**验证**:
- [ ] 显示饮食类型
- [ ] 显示过敏原
- [ ] 显示最爱食物（如果有）

---

#### 测试 12: 中文偏好命令

**发送**: `偏好`

**预期结果**: 与 `preferences` 相同

**验证**:
- [ ] 中文命令正常

---

### 第四部分：智能对话系统 (5 分钟)

#### 测试 13: 健康状况理解

**发送**: `我有糖尿病`

**预期结果**:
```
明白了！你有糖尿病，需要控制血糖。

我会帮你：
• 识别高糖食物
• 推荐低GI食物
• 提醒你注意碳水摄入

要设置控糖目标吗？
发送: profile
```

**验证**:
- [ ] 理解健康状况
- [ ] 提供相关建议
- [ ] 主动推理需求
- [ ] 不是机械回复

---

#### 测试 14: 复杂问题

**发送**: `我想增肌但是我不吃肉`

**预期结果**:
```
好的！你想增肌但是素食。

我建议：
• 豆腐、豆制品（高蛋白）
• 鸡蛋、牛奶（如果吃）
• 坚果、种子
• 藜麦、扁豆

每餐要有足够蛋白质 lah！
目标: 每公斤体重 1.6-2.2g 蛋白质

发送食物照片，我帮你分析！
```

**验证**:
- [ ] 理解复杂需求
- [ ] 记住之前的偏好（素食）
- [ ] 提供具体建议
- [ ] 上下文连贯

---

#### 测试 15: 随意聊天

**发送**: `你好`

**预期结果**:
```
你好 lah！😊

我是 Vita AI，你的营养助手。

需要帮忙吗？
• 发送食物照片 📸
• 查看连续: streak
• 设置预算: budget
• 查看偏好: preferences

有什么问题尽管问！
```

**验证**:
- [ ] 友好回应
- [ ] 提供帮助选项
- [ ] 不重复欢迎消息

---

### 第五部分：集成测试 (5 分钟)

#### 测试 16: 发送食物照片（有预算）

**准备**: 确保已设置预算 1800 kcal

**操作**: 发送一张食物照片

**预期结果**:
```
🍽️ 印度煎饼配蛋

📊 营养成分:
• 卡路里: 450 kcal
• 蛋白质: 15g
• 碳水: 55g
• 脂肪: 18g

🟡 健康评分: 中等

💰 预算: 450/1800 kcal (25%)
🎯 剩余: 1350 kcal

建议: 不错的早餐选择！蛋白质充足。
```

**验证**:
- [ ] 食物识别正常
- [ ] 营养成分显示
- [ ] 健康评分显示
- [ ] 预算自动更新
- [ ] 显示剩余卡路里
- [ ] 提供建议

---

#### 测试 17: 再次查看预算

**发送**: `budget`

**预期结果**: 显示更新后的预算（包含刚才的餐食）

**验证**:
- [ ] 预算已更新
- [ ] 消耗卡路里增加

---

#### 测试 18: 查看历史

**发送**: `history`

**预期结果**:
```
📊 你的最近餐食

1. 🟡 印度煎饼配蛋
   450 kcal • 刚刚

2. 🟢 鸡肉饭
   550 kcal • 1天前

...

输入"统计"查看详细数据。
```

**验证**:
- [ ] 显示最近餐食
- [ ] 包含刚才的记录
- [ ] 显示时间
- [ ] 显示健康评分

---

#### 测试 19: 查看统计

**发送**: `stats`

**预期结果**:
```
📈 你的统计数据

📊 总餐数: X

🍽️ 每餐平均:
• XXX kcal
• XXg 蛋白质
• XXg 碳水
• XXg 脂肪

🎯 健康评分:
🟢 健康: X
🟡 中等: X
🔴 不健康: X

输入"历史"查看最近餐食。
```

**验证**:
- [ ] 显示总餐数
- [ ] 显示平均营养
- [ ] 显示健康评分分布

---

### 第六部分：其他命令 (5 分钟)

#### 测试 20: 帮助命令

**发送**: `help`

**预期结果**:
```
🤖 Vita AI 帮助

核心功能:
📸 发送食物照片 → 获取即时分析
💬 告诉我您的信息 → 设置画像

命令:
• streak - 查看打卡连续
• stats - 查看统计数据
• budget - 追踪每日卡路里
• profile - 查看/更新画像
• history - 最近餐食
• preferences - 饮食偏好

快速操作:
使用下方按钮！
```

**验证**:
- [ ] 显示所有命令
- [ ] 简短说明
- [ ] 提供按钮

---

#### 测试 21: 画像命令

**发送**: `profile`

**预期结果**:
```
📊 你的健康画像

• 身高: 166 cm
• 体重: 50 kg
• 年龄: 28
• 性别: 女
• BMI: 18.1
• 目标: 增肌
• 活动: 轻度活动

要更新画像，直接告诉我:
"我现在 52kg" 或 "我身高 168cm"
```

**验证**:
- [ ] 显示完整画像
- [ ] BMI 计算正确
- [ ] 提供更新指引

---

#### 测试 22: 自然语言更新画像

**发送**: `我现在 52kg`

**预期结果**:
```
✅ 更新成功！

体重: 50kg → 52kg
BMI: 18.1 → 18.9

继续保持 lah！
```

**验证**:
- [ ] 理解自然语言
- [ ] 更新成功
- [ ] 显示变化

---

## 📊 测试结果记录表

| 测试编号 | 测试项目 | 结果 | 备注 |
|---------|---------|------|------|
| 1 | streak 命令 | ⬜ | |
| 2 | 中文连续命令 | ⬜ | |
| 3 | 自然语言连续 | ⬜ | |
| 4 | budget 查看（未设置） | ⬜ | |
| 5 | budget 设置 | ⬜ | |
| 6 | budget 查看（已设置） | ⬜ | |
| 7 | 中文预算命令 | ⬜ | |
| 8 | preferences 查看（未设置） | ⬜ | |
| 9 | 素食偏好设置 | ⬜ | |
| 10 | 过敏设置 | ⬜ | |
| 11 | preferences 查看（已设置） | ⬜ | |
| 12 | 中文偏好命令 | ⬜ | |
| 13 | 健康状况理解 | ⬜ | |
| 14 | 复杂问题理解 | ⬜ | |
| 15 | 随意聊天 | ⬜ | |
| 16 | 食物照片 + 预算集成 | ⬜ | |
| 17 | 预算自动更新 | ⬜ | |
| 18 | 历史记录 | ⬜ | |
| 19 | 统计数据 | ⬜ | |
| 20 | 帮助命令 | ⬜ | |
| 21 | 画像命令 | ⬜ | |
| 22 | 自然语言更新 | ⬜ | |

**图例**: ✅ 通过 | ❌ 失败 | ⚠️ 部分通过 | ⬜ 未测试

---

## 🎯 测试完成后

### 1. 检查数据库

运行以下命令检查数据是否正确保存：

```bash
node test-comprehensive-scenarios.mjs
```

### 2. 记录问题

如果发现任何问题，记录：
- 发送的消息
- 预期结果
- 实际结果
- 错误消息（如果有）

### 3. 提供反馈

测试完成后，告诉我：
- 哪些功能工作正常
- 哪些功能有问题
- 用户体验如何
- 有什么改进建议

---

## 📝 注意事项

1. **测试顺序**: 建议按照上述顺序测试，因为有些测试依赖前面的设置
2. **等待时间**: 每次发送消息后等待 2-3 秒，确保系统处理完成
3. **照片质量**: 测试 16 使用清晰的食物照片
4. **语言切换**: 可以随时切换中英文测试
5. **错误处理**: 如果遇到错误，记录下来继续测试其他功能

---

**准备好了吗？开始测试吧！** 🚀
